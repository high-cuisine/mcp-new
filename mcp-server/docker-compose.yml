services:
  mcp:
    build: .
    container_name: mcp
    ports:
      - 8080:8080
    volumes:
      - ./mcp_data:/data/mcp
      - ./libs/infractructure/rag/questions:/app/knowledge_base
    depends_on:
      - mongo
      - redis
      - chromadb
    networks:
      - telegram-network
    environment:
      - PORT=8080
      - CHROMA_PATH=http://chromadb:8000
      - CSV_KNOWLEDGE_BASE_PATH=/app/knowledge_base
  mongo:
    image: mongo:latest
    ports:
      - 27017:27017
    environment:
      - MONGO_INITDB_ROOT_USERNAME=admin
      - MONGO_INITDB_ROOT_PASSWORD=admin
    volumes:
      - ./mongo_data:/data/db
    networks:
      - telegram-network

    depends_on:
      - redis
  redis:
    image: redis:latest
    ports:
      - 6379:6379
    environment:
      - REDIS_PASSWORD=admin
    volumes:
      - ./redis_data:/data
    networks:
      - telegram-network
  chromadb:
    image: chromadb/chroma:latest
    container_name: chromadb
    ports:
      - 8000:8000
    environment:
      - IS_PERSISTENT=TRUE
      - ANONYMIZED_TELEMETRY=FALSE
    volumes:
      - ./chroma_data:/chroma/chroma
    networks:
      - telegram-network
networks:
  telegram-network:
    name: telegram-network
    driver: bridge